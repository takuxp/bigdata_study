# 컬럼 type 확인
train.info()

# 요약정보 확인
train.describe()

# 결측치 확인
train.isnull().sum()

# 결측치 제거
df.dropna()

# 결측치 변경
df.fillna(value)

# 사분위
- 1사분위
print(df['f1'].quantile(.25))
- 3사분위
print(df['f1'].quantile(.75))

# sort  
df = df.sort_values('순전입 학생', ascending=False)

# 해당 열의 고유값 카운트(고유한 행의 수)
df['Roof'].value_counts()

# iloc  
- 첫번째 행
df.iloc[0]
- 첫번째 열
df.iloc[:,0]
- 첫번째 행 마지막 열
df.iloc[0, -1]
- 응용
df['총범죄'] = df.iloc[:,1:-1].sum(axis=1)

# loc
df.loc['row name', 'cloumn name']

# GroupBy
result = df.groupby('소방서')['diff'].mean()

# 스케일링
from sklearn.preprocessing import minmax_scale  
data["qsec"] = minmax_scale(data["qsec"])

# 레이블인코딩
from sklearn.preprocessing import LabelEncoder  
cols1 = ['주구매상품', '주구매지점']  
le = LabelEncoder()  
for col in cols1:  
    train[col] = le.fit_transform(train[col])  
    test[col] = le.fit_transform(test[col])  

# 원핫 인코딩
train = pd.get_dummies(train)
test = pd.get_dummies(test)

# 트레인데이터테스트데이터 나누기(검증데이터 분리)
from sklearn.model_selection import train_test_split  
X_tr, X_val, y_tr, y_val = train_test_split(  
	train, target, test_size=0.2, random_state=0  
)

# 모델학습
- 분류
from sklearn.ensemble import RandomForestClassifier  
model = RandomForestClassifier()  
model.fit(X_tr, y_tr)  
pred = model.predict_proba(X_val)  
- 회귀
from sklearn.ensemble import RandomForestRegressor  
rf = RandomForestRegressor()  
rf.fit(X_tr, y_tr)  
pred = rf.predict(X_val)  

# 평가
from sklearn.metrics import roc_auc_score  
print(roc_auc_score(y_val, pred[:, 1]))  

# csv생성
result = pd.DataFrame({  
    'pred': pred  
})
result.to_csv('result.csv', index=False)  


